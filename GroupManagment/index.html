<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Person Location Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="sidebar">
        <div class="header-controls">
            <h2>Location Tracker</h2>
            <button id="open-config" class="config-button" title="Settings">⚙️</button>
        </div>
        
        <div class="search-box">
            <input id="search-input" type="text" placeholder="Search for a location...">
        </div>
        
        <div class="action-buttons">
            <button id="add-person">Add Person</button>
            <button id="add-meeting">Add Meeting Point</button>
        </div>
        
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="people-tab">People</button>
                <button class="tab-button" data-tab="meetings-tab">Meeting Points</button>
            </div>
            
            <div id="people-tab" class="tab-content active">
                <div class="filter-controls">
                    <div class="filter-section">
                        <label>Filter by Role:</label>
                        <div class="checkbox-item">
                            <input type="checkbox" id="filter-elder">
                            <label for="filter-elder">Elder</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="filter-servant">
                            <label for="filter-servant">Servant</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="filter-pioneer">
                            <label for="filter-pioneer">Pioneer</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="filter-familyhead">
                            <label for="filter-familyhead">Family Head</label>
                        </div>
                    </div>
                    <button id="apply-filter">Apply Filter</button>
                    <button id="clear-filter">Clear Filter</button>
                </div>
                
                <div class="person-list" id="person-list">
                    <!-- People will be listed here -->
                </div>
            </div>
            
            <div id="meetings-tab" class="tab-content">
                <div class="person-list" id="meeting-list">
                    <!-- Meeting points will be listed here -->
                </div>
            </div>
        </div>
        
        <div class="group-controls">
            <h3>Groups</h3>
            <div id="group-list">
                <!-- Groups will be listed here -->
            </div>
            <button id="create-group">Create Group</button>
            <button id="auto-group">Auto Group by Area</button>
        </div>
    </div>
    
    <div id="map-container">
        <div id="map"></div>
    </div>
    
    <!-- Person Add/Edit Modal -->
    <div id="person-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">Add Person</h3>
            <input id="person-name" type="text" placeholder="Name">
            
            <div class="checkbox-group">
                <h4>Role/Status</h4>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-elder">
                    <label for="person-elder">Elder</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-servant">
                    <label for="person-servant">Servant</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-pioneer">
                    <label for="person-pioneer">Pioneer</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-spouse">
                    <label for="person-spouse">Spouse</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-child">
                    <label for="person-child">Child</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="person-familyhead">
                    <label for="person-familyhead">Family Head</label>
                </div>
            </div>
            
            <select id="person-group">
                <option value="">No Group</option>
                <!-- Groups will be added here -->
            </select>
            <button id="save-person">Save</button>
            <button id="cancel-person">Cancel</button>
        </div>
    </div>
    
    <!-- Meeting Point Modal -->
    <div id="meeting-modal" class="modal">
        <div class="modal-content">
            <h3 id="meeting-modal-title">Add Meeting Point</h3>
            <input id="meeting-name" type="text" placeholder="Meeting Point Name">
            <textarea id="meeting-description" placeholder="Description" rows="3"></textarea>
            <select id="meeting-group">
                <option value="">No Group</option>
                <!-- Groups will be added here -->
            </select>
            <button id="save-meeting">Save</button>
            <button id="cancel-meeting">Cancel</button>
        </div>
    </div>
    
    <!-- Group Creation Modal -->
    <div id="group-modal" class="modal">
        <div class="modal-content">
            <h3>Create Group</h3>
            <input id="group-name" type="text" placeholder="Group Name">
            <input id="group-color" type="color" value="#FF0000">
            <button id="save-group">Save</button>
            <button id="cancel-group">Cancel</button>
        </div>
    </div>
    
    <!-- Configuration Modal -->
    <div id="config-modal" class="modal">
        <div class="modal-content config-modal-content">
            <h3>Configuration</h3>
            
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="appearance-tab">Appearance</button>
                    <button class="tab-button" data-tab="autogroup-tab">Auto-Grouping</button>
                </div>
                
                <div id="appearance-tab" class="tab-content active">
                    <h4>Marker Appearance</h4>
                    
                    <div class="config-section">
                        <h5>Person Markers</h5>
                        <div class="config-row">
                            <label>Default Icon:</label>
                            <select id="person-icon-select">
                                <option value="default">Default Marker</option>
                                <option value="circle">Circle</option>
                                <option value="square">Square</option>
                                <option value="star">Star</option>
                                <option value="person">Person Silhouette</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <label>Default Color:</label>
                            <input type="color" id="person-color" value="#FF0000">
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h5>Meeting Point Markers</h5>
                        <div class="config-row">
                            <label>Default Icon:</label>
                            <select id="meeting-icon-select">
                                <option value="blue-dot">Blue Dot</option>
                                <option value="green-dot">Green Dot</option>
                                <option value="purple-dot">Purple Dot</option>
                                <option value="flag">Flag</option>
                                <option value="info">Info</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <label>Default Color:</label>
                            <input type="color" id="meeting-color" value="#0000FF">
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h5>Group Settings</h5>
                        <div class="config-row">
                            <label>Group Marker Style:</label>
                            <select id="group-icon-select">
                                <option value="circle">Circle</option>
                                <option value="square">Square</option>
                                <option value="star">Star</option>
                                <option value="custom-color">Custom Color Only</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div id="autogroup-tab" class="tab-content">
                    <h4>Auto-Grouping Settings</h4>
                    
                    <div class="config-section">
                        <div class="config-row">
                            <label>Distance Threshold (km):</label>
                            <input type="number" id="distance-threshold" value="1" min="0.1" max="10" step="0.1">
                        </div>
                        
                        <h5>Group Composition Requirements</h5>
                        <div class="config-row">
                            <label>Minimum Group Size:</label>
                            <input type="number" id="min-group-size" value="2" min="2" max="20">
                        </div>
                        <div class="config-row">
                            <label>Minimum Elders per Group:</label>
                            <input type="number" id="min-elders" value="0" min="0" max="10">
                        </div>
                        <div class="config-row">
                            <label>Minimum Servants per Group:</label>
                            <input type="number" id="min-servants" value="0" min="0" max="10">
                        </div>
                        <div class="config-row">
                            <label>Minimum Pioneers per Group:</label>
                            <input type="number" id="min-pioneers" value="0" min="0" max="10">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="config-buttons">
                <button id="save-config">Save Configuration</button>
                <button id="cancel-config">Cancel</button>
                <button id="reset-config">Reset to Defaults</button>
            </div>
        </div>
    </div>

    <!-- Load JavaScript files -->
    <script src="js/api-config.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/person.js"></script>
    <script src="js/meeting.js"></script>
    <script src="js/group.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app-config.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Load the Google Maps API with the Places library -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create and append the Google Maps script dynamically
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places&callback=initMap`;
            script.async = true;
            script.defer = true;
            document.body.appendChild(script);
        });
    </script>
</body>
</html>